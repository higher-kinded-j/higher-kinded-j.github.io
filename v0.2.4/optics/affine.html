<!DOCTYPE HTML>
<html lang="en" class="latte sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Affines - Higher-Kinded Types and Optics for Java</title>


        <!-- Custom HTML head -->


            <meta name="description" content="Explore Higher-Kinded Types (HKTs) and Optcs in Java with the Higher-Kinded-J library. Learn about Functors, Applicatives, Monads, Transformers, practical functional patterns, and how to write cleaner, more composable Java code for your projects using Optics.">


        <meta name="keywords" content="Higher-Kinded Types, Higher-Kinded-J, Higher-Kinded Java, Higher Kinded Java, HKT, Java, Optics, Lens, Prism, Traversal, Iso, Functional Programming, Monad, Functor, Applicative, Transformer, Monoid, Traverse, higherkindedj">
        
        <meta property="og:title" content="Affines - Higher-Kinded Types and Optics for Java"> 
            <meta property="og:description" content="Explore Higher-Kinded Types (HKTs) and Optcs in Java with the Higher-Kinded-J library. Learn about Functors, Applicatives, Monads, Transformers, practical functional patterns, and how to write cleaner, more composable Java code for your projects using Optics.">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://higher-kinded-j.github.io/"> 
        
        <meta property="og:image" content="https://higher-kinded-j.github.io/preview.png" />
        <meta property="og:site_name" content="Higher-Kinded-J Documentation" />
        
        
        <meta name="twitter:card" content="summary_large_image" /> <meta name="twitter:title" content="Affines - Higher-Kinded Types and Optics for Java - Higher-Kinded-J" />
        <meta name="twitter:description" content="Bringing Higher-Kinded Types and Optics to Java functional patterns" />
        <meta name="twitter:image" content="https://higher-kinded-j.github.io/preview.png" />
        <meta name="description" content="Explore Higher-Kinded Types (HKTs) and Optcs in Java with the Higher-Kinded-J library. Learn about Functors, Applicatives, Monads, Transformers, practical functional patterns, and how to write cleaner, more composable Java code for your projects using Optics.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">
        <meta name="google-site-verification" content="X-xsiAq2cKMLOzh9dexUrX8Onx2h_YMUFgp5lHHUwSg" />
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././mdbook-admonish.css">
        <link rel="stylesheet" href=".././theme/catppuccin.css">
        <link rel="stylesheet" href=".././theme/catppuccin-admonish.css">
        <link rel="stylesheet" href=".././theme/catppuccin-alerts.css">
        <link rel="stylesheet" href=".././theme/additional-hkj.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "latte";
            const default_dark_theme = "macchiato";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('latte')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <div class="version-selector-container">
                            <select id="version-selector" class="version-selector" aria-label="Select documentation version" title="Select documentation version">
                                <option value="">Loading versions...</option>
                            </select>
                        </div>
                    </div>

                    <h1 class="menu-title">Higher-Kinded Types and Optics for Java</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/higher-kinded-j/higher-kinded-j" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/higher-kinded-j/higher-kinded-j/edit/main/hkj-book/src/optics/affine.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="affines-a-practical-guide"><a class="header" href="#affines-a-practical-guide">Affines: A Practical Guide</a></h1>
<h2 id="working-with-optional-fields"><a class="header" href="#working-with-optional-fields"><em>Working with Optional Fields</em></a></h2>
<div id="admonition-what-youll-learn" class="admonition admonish-info" role="note" aria-labelledby="admonition-what-youll-learn-title">
<div class="admonition-title">
<div id="admonition-what-youll-learn-title">
<p>What You'll Learn</p>
</div>
<a class="admonition-anchor-link" href="#admonition-what-youll-learn"></a>
</div>
<div>
<ul>
<li>How to safely work with optional fields and nullable properties</li>
<li>The difference between Affine, Lens, and Prism</li>
<li>Why <code>Lens.andThen(Prism)</code> produces an Affine, not a Traversal</li>
<li>Composing affines with other optics for deep optional access</li>
<li>Handling zero-or-one element focus without boilerplate</li>
<li>When to use Affines vs Prisms vs Lenses</li>
</ul>
</div>
</div>
<div id="admonition-example-code" class="admonition admonish-note" role="note" aria-labelledby="admonition-example-code-title">
<div class="admonition-title">
<div id="admonition-example-code-title">
<p>Example Code</p>
</div>
<a class="admonition-anchor-link" href="#admonition-example-code"></a>
</div>
<div>
<p><a href="https://github.com/higher-kinded-j/higher-kinded-j/blob/main/hkj-examples/src/main/java/org/higherkindedj/example/optics/AffineUsageExample.java">AffineUsageExample</a></p>
</div>
</div>
<p>We've seen how a <strong>Lens</strong> focuses on exactly one value that is guaranteed to exist, and how a <strong>Prism</strong> focuses on a value that may or may not exist depending on the variant.</p>
<p>But what about fields that are <em>sometimes</em> there? Optional fields in records, nullable properties in legacy APIs, or the result of composing a Lens with a Prism? This is the domain of the <strong>Affine</strong>.</p>
<hr />
<h2 id="the-scenario-optional-fields-in-records"><a class="header" href="#the-scenario-optional-fields-in-records">The Scenario: Optional Fields in Records</a></h2>
<p>Modern Java applications frequently use <code>Optional&lt;T&gt;</code> to represent values that may be absent. Consider a user profile with optional contact information:</p>
<pre><code class="language-java">record UserProfile(String username, Optional&lt;ContactInfo&gt; contact) {}
record ContactInfo(String email, Optional&lt;String&gt; phone) {}
</code></pre>
<p><strong>Our Goal:</strong> We need to safely access and update the phone number, which is doubly optional: the contact info might not exist, and even if it does, the phone number might be absent.</p>
<hr />
<h2 id="think-of-affines-like"><a class="header" href="#think-of-affines-like">Think of Affines Like...</a></h2>
<ul>
<li><strong>A Lens with uncertainty</strong>: Gets exactly one value <em>if</em> it exists</li>
<li><strong>A Prism without construction</strong>: Can update but not build from scratch</li>
<li><strong>An optional field accessor</strong>: Perfect for <code>Optional&lt;T&gt;</code> fields</li>
<li><strong>A Lens + Prism composition</strong>: The natural result of combining them</li>
</ul>
<hr />
<h2 id="understanding-the-optic-hierarchy"><a class="header" href="#understanding-the-optic-hierarchy">Understanding the Optic Hierarchy</a></h2>
<p>An Affine sits between Lens and Traversal in the optic hierarchy:</p>
<pre><code>         Iso
        /   \
     Lens   Prism
        \   /
        Affine
          |
       Traversal
</code></pre>
<p><strong>Key insight:</strong> When you compose a Lens (exactly one element) with a Prism (zero or one element), the result focuses on zero or one element, which is an Affine.</p>
<div class="table-wrapper"><table><thead><tr><th>Optic</th><th>Focus</th><th>Get</th><th>Set</th></tr></thead><tbody>
<tr><td><strong>Lens</strong></td><td>Exactly one</td><td>Always succeeds</td><td>Always succeeds</td></tr>
<tr><td><strong>Prism</strong></td><td>Zero or one</td><td>May fail</td><td>Can build from scratch</td></tr>
<tr><td><strong>Affine</strong></td><td>Zero or one</td><td>May fail</td><td>Requires existing structure</td></tr>
<tr><td><strong>Traversal</strong></td><td>Zero or more</td><td>Multiple values</td><td>Multiple values</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="a-step-by-step-walkthrough"><a class="header" href="#a-step-by-step-walkthrough">A Step-by-Step Walkthrough</a></h2>
<h3 id="step-1-creating-an-affine-manually"><a class="header" href="#step-1-creating-an-affine-manually">Step 1: Creating an Affine Manually</a></h3>
<p>An Affine is defined by two operations:</p>
<ul>
<li><strong><code>getOptional(source)</code></strong>: Returns <code>Optional&lt;A&gt;</code> containing the focus if present</li>
<li><strong><code>set(value, source)</code></strong>: Returns a new source with the focus updated</li>
</ul>
<pre><code class="language-java">import org.higherkindedj.optics.Affine;
import java.util.Optional;

// Affine for accessing the value inside an Optional field
Affine&lt;Optional&lt;String&gt;, String&gt; someAffine = Affine.of(
    Function.identity(),                    // getOptional: Optional&lt;String&gt; -&gt; Optional&lt;String&gt;
    (opt, value) -&gt; Optional.of(value)      // set: always wrap in Optional.of
);

// Usage
Optional&lt;String&gt; present = Optional.of("hello");
Optional&lt;String&gt; result = someAffine.getOptional(present);  // Optional.of("hello")

Optional&lt;String&gt; empty = Optional.empty();
Optional&lt;String&gt; noMatch = someAffine.getOptional(empty);   // Optional.empty()

// Setting always wraps the value
Optional&lt;String&gt; updated = someAffine.set("world", empty);  // Optional.of("world")
</code></pre>
<h3 id="step-2-using-the-affines-utility-class"><a class="header" href="#step-2-using-the-affines-utility-class">Step 2: Using the Affines Utility Class</a></h3>
<p>The <code>Affines</code> utility class provides ready-made affines for common patterns:</p>
<pre><code class="language-java">import org.higherkindedj.optics.util.Affines;

// For Optional&lt;T&gt; fields
Affine&lt;Optional&lt;String&gt;, String&gt; someAffine = Affines.some();

// For Maybe&lt;T&gt; (higher-kinded-j's Maybe type)
Affine&lt;Maybe&lt;String&gt;, String&gt; justAffine = Affines.just();

// For nullable fields (legacy code)
Affine&lt;@Nullable String, String&gt; nullableAffine = Affines.nullable();

// For list element access
Affine&lt;List&lt;String&gt;, String&gt; headAffine = Affines.listHead();
Affine&lt;List&lt;String&gt;, String&gt; lastAffine = Affines.listLast();
Affine&lt;List&lt;String&gt;, String&gt; thirdAffine = Affines.listAt(2);
</code></pre>
<h3 id="step-3-affine-from-lens--prism-composition"><a class="header" href="#step-3-affine-from-lens--prism-composition">Step 3: Affine from Lens + Prism Composition</a></h3>
<p>The most common way to obtain an Affine is through composition:</p>
<pre><code class="language-java">import org.higherkindedj.optics.Lens;
import org.higherkindedj.optics.Prism;
import org.higherkindedj.optics.util.Prisms;

// Domain model
record Config(Optional&lt;DatabaseSettings&gt; database) {}
record DatabaseSettings(String host, int port) {}

// Lens to the Optional field
Lens&lt;Config, Optional&lt;DatabaseSettings&gt;&gt; databaseLens =
    Lens.of(Config::database, (c, db) -&gt; new Config(db));

// Prism to extract from Optional
Prism&lt;Optional&lt;DatabaseSettings&gt;, DatabaseSettings&gt; somePrism = Prisms.some();

// Composition: Lens &gt;&gt;&gt; Prism = Affine
Affine&lt;Config, DatabaseSettings&gt; databaseAffine =
    databaseLens.andThen(somePrism);

// Usage
Config config1 = new Config(Optional.of(new DatabaseSettings("localhost", 5432)));
Optional&lt;DatabaseSettings&gt; result1 = databaseAffine.getOptional(config1);
// result1 = Optional[DatabaseSettings[host=localhost, port=5432]]

Config config2 = new Config(Optional.empty());
Optional&lt;DatabaseSettings&gt; result2 = databaseAffine.getOptional(config2);
// result2 = Optional.empty()

// Setting through the affine
Config updated = databaseAffine.set(new DatabaseSettings("newhost", 3306), config2);
// updated = Config[database=Optional[DatabaseSettings[host=newhost, port=3306]]]
</code></pre>
<div id="admonition-why-affine-not-traversal" class="admonition admonish-tip" role="note" aria-labelledby="admonition-why-affine-not-traversal-title">
<div class="admonition-title">
<div id="admonition-why-affine-not-traversal-title">
<p>Why Affine, not Traversal?</p>
</div>
<a class="admonition-anchor-link" href="#admonition-why-affine-not-traversal"></a>
</div>
<div>
<p>You might wonder why <code>Lens.andThen(Prism)</code> returns an Affine rather than a Traversal. The answer is precision:</p>
<ul>
<li><strong>Traversal</strong> focuses on <em>zero or more</em> elements</li>
<li><strong>Affine</strong> focuses on <em>exactly zero or one</em> element</li>
</ul>
<p>Since a Lens always provides one element and a Prism may match zero or one, the composition can never produce <em>more</em> than one element. Affine captures this constraint precisely, giving you stronger type guarantees.</p>
</div>
</div>
<hr />
<h2 id="affine-vs-prism-the-key-difference"><a class="header" href="#affine-vs-prism-the-key-difference">Affine vs Prism: The Key Difference</a></h2>
<p>Both Affine and Prism focus on zero-or-one elements, but they differ in one crucial way:</p>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Prism</th><th>Affine</th></tr></thead><tbody>
<tr><td><strong>getOptional</strong></td><td>✅ Yes</td><td>✅ Yes</td></tr>
<tr><td><strong>set</strong></td><td>✅ Yes</td><td>✅ Yes</td></tr>
<tr><td><strong>build</strong></td><td>✅ Yes (construct from part)</td><td>❌ No</td></tr>
</tbody></table>
</div>
<p>A <strong>Prism</strong> can <em>construct</em> a complete structure from just the focused part (via <code>build</code>). An <strong>Affine</strong> cannot; it can only <em>modify</em> an existing structure.</p>
<pre><code class="language-java">// Prism: can build from scratch
Prism&lt;Shape, Circle&gt; circlePrism = ...;
Shape newCircle = circlePrism.build(new Circle(5.0, "red"));  // Works!

// Affine: cannot build, only update
Affine&lt;Config, DatabaseSettings&gt; dbAffine = ...;
// No build() method available; must have an existing Config to work with
Config updated = dbAffine.set(newSettings, existingConfig);
</code></pre>
<p><strong>When to use which:</strong></p>
<ul>
<li>Use <strong>Prism</strong> for sum types where you can construct variants</li>
<li>Use <strong>Affine</strong> for optional fields in product types</li>
</ul>
<hr />
<h2 id="convenience-methods"><a class="header" href="#convenience-methods">Convenience Methods</a></h2>
<p>The <code>Affine</code> interface provides several convenience methods for common operations:</p>
<p><strong>Quick Reference:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Method</th><th>Purpose</th><th>Returns</th></tr></thead><tbody>
<tr><td><code>matches(S source)</code></td><td>Check if affine focuses on a value</td><td><code>boolean</code></td></tr>
<tr><td><code>doesNotMatch(S source)</code></td><td>Check if affine has no focus</td><td><code>boolean</code></td></tr>
<tr><td><code>getOrElse(A default, S source)</code></td><td>Extract value or return default</td><td><code>A</code></td></tr>
<tr><td><code>mapOptional(Function&lt;A, B&gt; f, S source)</code></td><td>Transform focused value</td><td><code>Optional&lt;B&gt;</code></td></tr>
<tr><td><code>modify(Function&lt;A, A&gt; f, S source)</code></td><td>Modify if present, else return original</td><td><code>S</code></td></tr>
<tr><td><code>modifyWhen(Predicate&lt;A&gt; p, Function&lt;A, A&gt; f, S source)</code></td><td>Modify only when predicate satisfied</td><td><code>S</code></td></tr>
<tr><td><code>setWhen(Predicate&lt;A&gt; p, A value, S source)</code></td><td>Set only when predicate satisfied</td><td><code>S</code></td></tr>
<tr><td><code>remove(S source)</code></td><td>Remove the focused element (if supported)</td><td><code>S</code></td></tr>
</tbody></table>
</div>
<h3 id="checking-for-presence"><a class="header" href="#checking-for-presence">Checking for Presence</a></h3>
<pre><code class="language-java">Affine&lt;Optional&lt;String&gt;, String&gt; someAffine = Affines.some();

Optional&lt;String&gt; present = Optional.of("hello");
Optional&lt;String&gt; empty = Optional.empty();

// Using matches()
if (someAffine.matches(present)) {
    System.out.println("Value present");
}

// Using doesNotMatch()
if (someAffine.doesNotMatch(empty)) {
    System.out.println("No value");
}

// Useful in streams
List&lt;Optional&lt;String&gt;&gt; values = List.of(
    Optional.of("a"),
    Optional.empty(),
    Optional.of("b")
);

long presentCount = values.stream()
    .filter(someAffine::matches)
    .count();  // 2
</code></pre>
<h3 id="default-values"><a class="header" href="#default-values">Default Values</a></h3>
<pre><code class="language-java">Affine&lt;Optional&lt;Config&gt;, Config&gt; configAffine = Affines.some();

Optional&lt;Config&gt; maybeConfig = loadConfig();

// Get value or use default
Config config = configAffine.getOrElse(Config.DEFAULT, maybeConfig);
</code></pre>
<h3 id="conditional-modification"><a class="header" href="#conditional-modification">Conditional Modification</a></h3>
<pre><code class="language-java">Affine&lt;Optional&lt;String&gt;, String&gt; someAffine = Affines.some();

Optional&lt;String&gt; value = Optional.of("hello world");

// Only modify if predicate is satisfied
Optional&lt;String&gt; result = someAffine.modifyWhen(
    s -&gt; s.length() &gt; 5,
    String::toUpperCase,
    value
);
// result = Optional.of("HELLO WORLD")

// Set only when condition is met
Optional&lt;String&gt; guarded = someAffine.setWhen(
    s -&gt; s.startsWith("hello"),
    "goodbye",
    value
);
// guarded = Optional.of("goodbye")
</code></pre>
<h3 id="removal-support"><a class="header" href="#removal-support">Removal Support</a></h3>
<p>Some affines support the <code>remove</code> operation to clear the focused element:</p>
<pre><code class="language-java">// Create an affine that supports removal
Affine&lt;Optional&lt;String&gt;, String&gt; removableAffine = Affines.someWithRemove();

Optional&lt;String&gt; present = Optional.of("hello");
Optional&lt;String&gt; cleared = removableAffine.remove(present);
// cleared = Optional.empty()
</code></pre>
<div id="admonition-remove-support" class="admonition admonish-warning" role="note" aria-labelledby="admonition-remove-support-title">
<div class="admonition-title">
<div id="admonition-remove-support-title">
<p>Remove Support</p>
</div>
<a class="admonition-anchor-link" href="#admonition-remove-support"></a>
</div>
<div>
<p>Not all affines support the <code>remove</code> operation. Calling <code>remove</code> on an affine that doesn't support it will return the source unchanged. Use <code>Affines.someWithRemove()</code> instead of <code>Affines.some()</code> when you need removal support.</p>
</div>
</div>
<hr />
<h2 id="composing-affines"><a class="header" href="#composing-affines">Composing Affines</a></h2>
<p>Affines compose with other optics following precise rules:</p>
<pre><code class="language-java">// Affine &gt;&gt;&gt; Affine = Affine
Affine&lt;A, C&gt; result = affineAB.andThen(affineBC);

// Affine &gt;&gt;&gt; Lens = Affine
Affine&lt;A, C&gt; result = affineAB.andThen(lensBC);

// Affine &gt;&gt;&gt; Prism = Affine
Affine&lt;A, C&gt; result = affineAB.andThen(prismBC);

// Affine &gt;&gt;&gt; Iso = Affine
Affine&lt;A, C&gt; result = affineAB.andThen(isoBC);

// Affine &gt;&gt;&gt; Traversal = Traversal
Traversal&lt;A, C&gt; result = affineAB.asTraversal().andThen(traversalBC);
</code></pre>
<h3 id="deep-optional-access-example"><a class="header" href="#deep-optional-access-example">Deep Optional Access Example</a></h3>
<pre><code class="language-java">record User(String name, Optional&lt;Address&gt; address) {}
record Address(String street, Optional&lt;String&gt; postcode) {}

// Build affines for each optional field
Lens&lt;User, Optional&lt;Address&gt;&gt; addressLens =
    Lens.of(User::address, (u, a) -&gt; new User(u.name(), a));

Lens&lt;Address, Optional&lt;String&gt;&gt; postcodeLens =
    Lens.of(Address::postcode, (a, p) -&gt; new Address(a.street(), p));

Prism&lt;Optional&lt;Address&gt;, Address&gt; addressPrism = Prisms.some();
Prism&lt;Optional&lt;String&gt;, String&gt; postcodePrism = Prisms.some();

// Compose to access nested optional
Affine&lt;User, String&gt; userPostcode =
    addressLens
        .andThen(addressPrism)           // Lens &gt;&gt;&gt; Prism = Affine
        .andThen(postcodeLens)           // Affine &gt;&gt;&gt; Lens = Affine
        .andThen(postcodePrism);         // Affine &gt;&gt;&gt; Prism = Affine

// Usage
User user1 = new User("Alice", Optional.of(
    new Address("123 Main St", Optional.of("SW1A 1AA"))
));
User user2 = new User("Bob", Optional.empty());

Optional&lt;String&gt; postcode1 = userPostcode.getOptional(user1);
// Optional.of("SW1A 1AA")

Optional&lt;String&gt; postcode2 = userPostcode.getOptional(user2);
// Optional.empty()

// Update deeply nested optional
User updated = userPostcode.set("EC1A 1BB", user1);
// User[name=Alice, address=Optional[Address[street=123 Main St, postcode=Optional[EC1A 1BB]]]]
</code></pre>
<hr />
<h2 id="factory-methods"><a class="header" href="#factory-methods">Factory Methods</a></h2>
<p>The <code>Affine</code> interface provides factory methods for common construction patterns:</p>
<h3 id="from-getter-and-setter"><a class="header" href="#from-getter-and-setter">From Getter and Setter</a></h3>
<pre><code class="language-java">// Basic construction
Affine&lt;S, A&gt; affine = Affine.of(
    s -&gt; getOptional(s),           // S -&gt; Optional&lt;A&gt;
    (s, a) -&gt; setInSource(s, a)    // (S, A) -&gt; S
);

// With removal support
Affine&lt;S, A&gt; removable = Affine.of(
    s -&gt; getOptional(s),           // S -&gt; Optional&lt;A&gt;
    (s, a) -&gt; setInSource(s, a),   // (S, A) -&gt; S
    s -&gt; removeFromSource(s)       // S -&gt; S
);
</code></pre>
<h3 id="from-lens-and-prism"><a class="header" href="#from-lens-and-prism">From Lens and Prism</a></h3>
<pre><code class="language-java">// Compose a Lens and Prism into an Affine
Affine&lt;S, B&gt; affine = Affine.fromLensAndPrism(
    lensAB,   // Lens&lt;S, A&gt;
    prismBC   // Prism&lt;A, B&gt;
);

// Compose a Prism and Lens into an Affine
Affine&lt;S, B&gt; affine = Affine.fromPrismAndLens(
    prismAB,  // Prism&lt;S, A&gt;
    lensBC    // Lens&lt;A, B&gt;
);
</code></pre>
<hr />
<h2 id="when-to-use-affines-vs-other-optics"><a class="header" href="#when-to-use-affines-vs-other-optics">When to Use Affines vs Other Optics</a></h2>
<h3 id="use-affine-when"><a class="header" href="#use-affine-when">Use Affine When:</a></h3>
<ul>
<li><strong>Optional fields</strong> in records or classes (<code>Optional&lt;T&gt;</code>)</li>
<li><strong>Nullable properties</strong> in legacy or interop code</li>
<li><strong>Conditional field access</strong> that may or may not exist</li>
<li><strong>Lens + Prism compositions</strong> where you need the precise type</li>
</ul>
<pre><code class="language-java">// Perfect for optional record fields
record Config(Optional&lt;String&gt; apiKey) {}

Affine&lt;Config, String&gt; apiKeyAffine =
    ConfigLenses.apiKey().andThen(Prisms.some());

Optional&lt;String&gt; key = apiKeyAffine.getOptional(config);
</code></pre>
<h3 id="use-lens-when"><a class="header" href="#use-lens-when">Use Lens When:</a></h3>
<ul>
<li>The field is <strong>always present</strong> (guaranteed to exist)</li>
<li>You're working with <strong>product types</strong> (records, classes)</li>
</ul>
<pre><code class="language-java">// Field always exists
record Point(int x, int y) {}
Lens&lt;Point, Integer&gt; xLens = Lens.of(Point::x, (p, x) -&gt; new Point(x, p.y()));
</code></pre>
<h3 id="use-prism-when"><a class="header" href="#use-prism-when">Use Prism When:</a></h3>
<ul>
<li>Working with <strong>sum types</strong> (sealed interfaces, enums)</li>
<li>You need to <strong>construct</strong> the whole from a part</li>
<li>Type-safe <strong>variant matching</strong></li>
</ul>
<pre><code class="language-java">// Sum type handling
sealed interface Shape permits Circle, Rectangle {}
Prism&lt;Shape, Circle&gt; circlePrism = ...;
Shape circle = circlePrism.build(new Circle(5.0));  // Can construct!
</code></pre>
<h3 id="use-traversal-when"><a class="header" href="#use-traversal-when">Use Traversal When:</a></h3>
<ul>
<li>Focusing on <strong>multiple elements</strong> (lists, sets)</li>
<li>You need to work with <strong>collections</strong></li>
</ul>
<pre><code class="language-java">// Multiple elements
Traversal&lt;List&lt;String&gt;, String&gt; listTraversal = Traversals.forList();
List&lt;String&gt; upper = Traversals.modify(listTraversal, String::toUpperCase, names);
</code></pre>
<hr />
<h2 id="common-pitfalls"><a class="header" href="#common-pitfalls">Common Pitfalls</a></h2>
<h3 id="dont-do-this"><a class="header" href="#dont-do-this">Don't Do This:</a></h3>
<pre><code class="language-java">// Overly complex: manual Optional handling
Optional&lt;String&gt; getNestedValue(Config config) {
    return config.database()
        .flatMap(db -&gt; db.connection())
        .flatMap(conn -&gt; conn.timeout())
        .map(Object::toString);
}

// Unsafe: assuming presence without checking
String value = config.database().get().host();  // NoSuchElementException!

// Verbose: repeated null checks
if (user.address() != null &amp;&amp; user.address().postcode() != null) {
    return user.address().postcode();
}
</code></pre>
<h3 id="do-this-instead"><a class="header" href="#do-this-instead">Do This Instead:</a></h3>
<pre><code class="language-java">// Clean: compose affines for deep access
Affine&lt;Config, String&gt; timeoutAffine =
    databaseAffine
        .andThen(connectionAffine)
        .andThen(timeoutLens)
        .andThen(Affines.some());

Optional&lt;String&gt; timeout = timeoutAffine.mapOptional(Object::toString, config);

// Safe: affine handles absence gracefully
String value = databaseAffine.getOrElse(defaultSettings, config).host();

// Composable: build reusable optics
Affine&lt;User, String&gt; postcodeAffine = UserOptics.postcode();
Optional&lt;String&gt; postcode = postcodeAffine.getOptional(user);
</code></pre>
<hr />
<h2 id="the-affine-laws"><a class="header" href="#the-affine-laws">The Affine Laws</a></h2>
<p>Well-behaved affines satisfy these laws:</p>
<h3 id="get-set-law"><a class="header" href="#get-set-law">Get-Set Law</a></h3>
<p>If a value is present, getting and then setting returns the original:</p>
<pre><code class="language-java">affine.getOptional(s).map(a -&gt; affine.set(a, s)).orElse(s) == s
</code></pre>
<h3 id="set-set-law"><a class="header" href="#set-set-law">Set-Set Law</a></h3>
<p>Setting twice is equivalent to setting once with the final value:</p>
<pre><code class="language-java">affine.set(b, affine.set(a, s)) == affine.set(b, s)
</code></pre>
<h3 id="getoptional-set-law"><a class="header" href="#getoptional-set-law">GetOptional-Set Law</a></h3>
<p>Setting a value and then getting returns that value (if the structure allows):</p>
<pre><code class="language-java">// When getOptional returns a value after set:
affine.getOptional(affine.set(a, s)) == Optional.of(a)
// (or Optional.empty() if the structure doesn't support the focus)
</code></pre>
<hr />
<h2 id="real-world-example-configuration-management"><a class="header" href="#real-world-example-configuration-management">Real-World Example: Configuration Management</a></h2>
<pre><code class="language-java">import org.higherkindedj.optics.Affine;
import org.higherkindedj.optics.Lens;
import org.higherkindedj.optics.util.Affines;
import org.higherkindedj.optics.util.Prisms;

import java.util.Optional;

// Domain model with nested optionals
record AppConfig(
    String appName,
    Optional&lt;DatabaseConfig&gt; database,
    Optional&lt;CacheConfig&gt; cache
) {}

record DatabaseConfig(
    String host,
    int port,
    Optional&lt;PoolConfig&gt; pool
) {}

record PoolConfig(int minSize, int maxSize) {}

record CacheConfig(String provider, int ttlSeconds) {}

public class ConfigOptics {
    // Lenses for required fields
    public static final Lens&lt;AppConfig, String&gt; appName =
        Lens.of(AppConfig::appName, (c, n) -&gt; new AppConfig(n, c.database(), c.cache()));

    public static final Lens&lt;AppConfig, Optional&lt;DatabaseConfig&gt;&gt; database =
        Lens.of(AppConfig::database, (c, db) -&gt; new AppConfig(c.appName(), db, c.cache()));

    public static final Lens&lt;DatabaseConfig, String&gt; host =
        Lens.of(DatabaseConfig::host, (db, h) -&gt; new DatabaseConfig(h, db.port(), db.pool()));

    public static final Lens&lt;DatabaseConfig, Optional&lt;PoolConfig&gt;&gt; pool =
        Lens.of(DatabaseConfig::pool, (db, p) -&gt; new DatabaseConfig(db.host(), db.port(), p));

    public static final Lens&lt;PoolConfig, Integer&gt; maxSize =
        Lens.of(PoolConfig::maxSize, (p, m) -&gt; new PoolConfig(p.minSize(), m));

    // Affines for optional access
    public static final Affine&lt;AppConfig, DatabaseConfig&gt; databaseAffine =
        database.andThen(Prisms.some());

    public static final Affine&lt;AppConfig, String&gt; databaseHost =
        databaseAffine.andThen(host);

    public static final Affine&lt;AppConfig, PoolConfig&gt; poolConfig =
        databaseAffine
            .andThen(pool)
            .andThen(Prisms.some());

    public static final Affine&lt;AppConfig, Integer&gt; poolMaxSize =
        poolConfig.andThen(maxSize);

    public static void main(String[] args) {
        // Create a config with nested optionals
        AppConfig config = new AppConfig(
            "MyApp",
            Optional.of(new DatabaseConfig(
                "localhost",
                5432,
                Optional.of(new PoolConfig(5, 20))
            )),
            Optional.empty()
        );

        // Read nested values safely
        System.out.println("Host: " + databaseHost.getOptional(config));
        // Host: Optional[localhost]

        System.out.println("Pool max: " + poolMaxSize.getOptional(config));
        // Pool max: Optional[20]

        // Update deeply nested value
        AppConfig updated = poolMaxSize.set(50, config);
        System.out.println("Updated pool max: " + poolMaxSize.getOptional(updated));
        // Updated pool max: Optional[50]

        // Conditional modification
        AppConfig doubled = poolMaxSize.modify(n -&gt; n * 2, config);
        System.out.println("Doubled pool max: " + poolMaxSize.getOptional(doubled));
        // Doubled pool max: Optional[40]

        // Safe operation on missing config
        AppConfig emptyConfig = new AppConfig("EmptyApp", Optional.empty(), Optional.empty());
        System.out.println("Missing host: " + databaseHost.getOptional(emptyConfig));
        // Missing host: Optional.empty

        // Modification on missing does nothing
        AppConfig unchanged = poolMaxSize.modify(n -&gt; n * 2, emptyConfig);
        System.out.println("Empty config unchanged: " + (unchanged == emptyConfig));
        // Empty config unchanged: true
    }
}
</code></pre>
<hr />
<h2 id="performance-notes"><a class="header" href="#performance-notes">Performance Notes</a></h2>
<p>Affines are designed for both safety and efficiency:</p>
<ul>
<li><strong>Zero allocation for absent values</strong>: <code>getOptional</code> returns <code>Optional.empty()</code> without allocating</li>
<li><strong>Short-circuit evaluation</strong>: Composed affines stop at the first absent value</li>
<li><strong>Immutable by design</strong>: All operations return new values, enabling safe concurrent use</li>
<li><strong>Inlinable</strong>: Simple affines are candidates for JVM inlining</li>
</ul>
<p><strong>Best Practice</strong>: Create composed affines once and reuse them:</p>
<pre><code class="language-java">public class UserOptics {
    // Create once, use everywhere
    public static final Affine&lt;User, String&gt; EMAIL =
        addressLens.andThen(addressPrism).andThen(emailLens);

    public static final Affine&lt;User, String&gt; POSTCODE =
        addressLens.andThen(addressPrism).andThen(postcodeLens).andThen(postcodePrism);
}
</code></pre>
<hr />
<h2 id="why-affines-are-essential"><a class="header" href="#why-affines-are-essential">Why Affines are Essential</a></h2>
<p>Affines fill an important gap in the optic hierarchy:</p>
<ul>
<li><strong>Precision</strong>: More precise than Traversal for zero-or-one access</li>
<li><strong>Composability</strong>: Natural result of Lens + Prism composition</li>
<li><strong>Safety</strong>: Eliminate null checks and <code>Optional.flatMap</code> chains</li>
<li><strong>Expressiveness</strong>: Clearly communicate "optional field" intent</li>
</ul>
<p>By adding Affines to your toolkit, you can write cleaner, safer code that handles optional data with the same elegance as required fields.</p>
<hr />
<h2 id="further-reading"><a class="header" href="#further-reading">Further Reading</a></h2>
<p>For deeper understanding of affines and optional field handling:</p>
<ul>
<li><a href="https://arxiv.org/abs/1703.10857">Profunctor Optics: Modular Data Accessors</a> – Academic foundation covering Affine as a profunctor optic</li>
<li><a href="https://www.optics.dev/Monocle/docs/optics/optional">Monocle Optional</a> – Scala's Monocle library uses "Optional" for the same concept</li>
<li><a href="https://www.baeldung.com/java-optional">Handling Optionality in Domain Models</a> – Baeldung's guide to Java Optional, the underlying type Affine often works with</li>
<li><a href="https://www.manning.com/books/functional-and-reactive-domain-modeling">Functional and Reactive Domain Modeling</a> – Manning book covering optics in domain design (Scala-focused but concepts transfer)</li>
</ul>
<div id="admonition-terminology-note" class="admonition admonish-tip" role="note" aria-labelledby="admonition-terminology-note-title">
<div class="admonition-title">
<div id="admonition-terminology-note-title">
<p>Terminology Note</p>
</div>
<a class="admonition-anchor-link" href="#admonition-terminology-note"></a>
</div>
<div>
<p>In some functional programming libraries (notably Scala's Monocle), the Affine optic is called an <strong>Optional</strong>. This can cause confusion with Java's <code>java.util.Optional</code>. In higher-kinded-j, we use the term "Affine" to avoid this ambiguity whilst maintaining mathematical precision.</p>
</div>
</div>
<hr />
<p><strong>Previous:</strong> <a href="prisms.html">Prisms: Working with Sum Types</a>
<strong>Next:</strong> <a href="iso.html">Isomorphisms: Data Equivalence</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../optics/prisms.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../optics/iso.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../optics/prisms.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../optics/iso.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../version-switcher.js"></script>
        <script src=".././theme/version-switcher.js"></script>


    </div>
    </body>
</html>
