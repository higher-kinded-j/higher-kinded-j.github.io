<!DOCTYPE HTML>
<html lang="en" class="latte sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ReaderT - Higher-Kinded-J: Composable Effects and Advanced Optics for Java</title>


        <!-- Custom HTML head -->


            <meta name="description" content="The most comprehensive functional programming library for Java. Unify error handling, optional values, and immutable data navigation with the Effect Path API and Focus DSL. Features advanced optics with code generation for Java records, filtered traversals, indexed optics, and seamless Spring Boot integration.">


        <meta name="keywords" content="Higher-Kinded Types, Higher-Kinded-J, HKT, Java, Optics, Lens, Prism, Traversal, Iso, Affine, Focus DSL, Effect Path API, Functional Programming, Monad, Functor, Applicative, EitherPath, MaybePath, TryPath, ValidationPath, Java Records, Sealed Interface, Error Handling, Immutable Data">
        
        <meta property="og:title" content="ReaderT - Higher-Kinded-J: Composable Effects and Advanced Optics for Java">
            <meta property="og:description" content="The most comprehensive functional programming library for Java. Unify error handling, optional values, and immutable data navigation with the Effect Path API and Focus DSL. Features advanced optics with code generation for Java records, filtered traversals, indexed optics, and seamless Spring Boot integration.">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://higher-kinded-j.github.io/">
        <meta property="og:image" content="https://higher-kinded-j.github.io/preview.png">
        <meta property="og:image:width" content="1200">
        <meta property="og:image:height" content="630">
        <meta property="og:site_name" content="Higher-Kinded-J Documentation">
        <meta property="og:locale" content="en_GB">
        
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="ReaderT - Higher-Kinded-J: Composable Effects and Advanced Optics for Java">
        <meta name="twitter:description" content="Unifying Composable Effects and Advanced Optics for Java. Effect Path API, Focus DSL, and the most comprehensive optics implementation in the Java ecosystem.">
        <meta name="twitter:image" content="https://higher-kinded-j.github.io/preview.png">
        <meta name="twitter:image:alt" content="Higher-Kinded-J: Composable Effects and Advanced Optics for Java">
        <meta name="description" content="The most comprehensive functional programming library for Java. Unify error handling, optional values, and immutable data navigation with the Effect Path API and Focus DSL. Features advanced optics with code generation for Java records, filtered traversals, indexed optics, and seamless Spring Boot integration.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">
        <meta name="google-site-verification" content="X-xsiAq2cKMLOzh9dexUrX8Onx2h_YMUFgp5lHHUwSg" />
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././mdbook-admonish.css">
        <link rel="stylesheet" href=".././theme/catppuccin.css">
        <link rel="stylesheet" href=".././theme/catppuccin-admonish.css">
        <link rel="stylesheet" href=".././theme/catppuccin-alerts.css">
        <link rel="stylesheet" href=".././theme/additional-hkj.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "latte";
            const default_dark_theme = "macchiato";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('latte')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <div class="version-selector-container">
                            <select id="version-selector" class="version-selector" aria-label="Select documentation version" title="Select documentation version">
                                <option value="">Loading versions...</option>
                            </select>
                        </div>
                    </div>

                    <h1 class="menu-title">Higher-Kinded-J: Composable Effects and Advanced Optics for Java</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/higher-kinded-j/higher-kinded-j" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/higher-kinded-j/higher-kinded-j/edit/main/hkj-book/src/transformers/readert_transformer.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="the-readert-transformer"><a class="header" href="#the-readert-transformer">The ReaderT Transformer:</a></h1>
<h2 id="threading-configuration-through-effects"><a class="header" href="#threading-configuration-through-effects"><em>Threading Configuration Through Effects</em></a></h2>
<blockquote>
<p><em>"No man is an island, entire of itself."</em></p>
<p>– John Donne, <em>Meditation XVII</em></p>
</blockquote>
<p>No computation is independent of its environment. ReaderT makes that dependency explicit and composable.</p>
<div id="admonition-what-youll-learn" class="admonition admonish-info" role="note" aria-labelledby="admonition-what-youll-learn-title">
<div class="admonition-title">
<div id="admonition-what-youll-learn-title">
<p>What You'll Learn</p>
</div>
<a class="admonition-anchor-link" href="#admonition-what-youll-learn"></a>
</div>
<div>
<ul>
<li>How to combine dependency injection (Reader) with other effects like async operations</li>
<li>Building configuration-dependent workflows that are also async or failable</li>
<li>Using <code>ask</code>, <code>reader</code>, and <code>lift</code> to work with environment-dependent computations</li>
<li>Creating testable microservice clients with injected configuration</li>
<li>Managing database connections, API keys, and other contextual dependencies</li>
</ul>
</div>
</div>
<div id="admonition-see-example-code" class="admonition admonish-example" role="note" aria-labelledby="admonition-see-example-code-title">
<div class="admonition-title">
<div id="admonition-see-example-code-title">
<p>See Example Code:</p>
</div>
<a class="admonition-anchor-link" href="#admonition-see-example-code"></a>
</div>
<div>
<ul>
<li>
<p><a href="https://github.com/higher-kinded-j/higher-kinded-j/blob/main/hkj-examples/src/main/java/org/higherkindedj/example/basic/reader_t/ReaderTExample.java">ReaderTExample.java</a></p>
</li>
<li>
<p><a href="https://github.com/higher-kinded-j/higher-kinded-j/blob/main/hkj-examples/src/main/java/org/higherkindedj/example/basic/reader_t/ReaderTAsyncExample.java">ReaderTAsyncExample.java</a></p>
</li>
<li>
<p><a href="https://github.com/higher-kinded-j/higher-kinded-j/blob/main/hkj-examples/src/main/java/org/higherkindedj/example/basic/reader_t/ReaderTAsyncUnitExample.java">ReaderTAsyncUnitExample.java</a></p>
</li>
</ul>
</div>
</div>
<hr />
<h2 id="the-problem-configuration-everywhere"><a class="header" href="#the-problem-configuration-everywhere">The Problem: Configuration Everywhere</a></h2>
<p>Consider a service that needs API keys and URLs for every operation:</p>
<pre><code class="language-java">// Without ReaderT: passing config through every function
CompletableFuture&lt;ServiceData&gt; fetchData(AppConfig config, String itemId) {
    return CompletableFuture.supplyAsync(() -&gt;
        callApi(config.apiKey(), config.serviceUrl(), itemId));
}

CompletableFuture&lt;ProcessedData&gt; processData(AppConfig config, ServiceData data) {
    return CompletableFuture.supplyAsync(() -&gt;
        transform(data, config.apiKey()));
}

// Every call requires explicit config passing:
CompletableFuture&lt;ProcessedData&gt; workflow(AppConfig config) {
    return fetchData(config, "item123")
        .thenCompose(data -&gt; processData(config, data));
}
</code></pre>
<p>The <code>config</code> parameter threads through every function signature, every call site, every test. It's noise that obscures the actual logic. Rename a config field, and you touch every function in the chain.</p>
<h2 id="the-solution-readert"><a class="header" href="#the-solution-readert">The Solution: ReaderT</a></h2>
<pre><code class="language-java">// With ReaderT: config is implicit
ReaderT&lt;CompletableFutureKind.Witness, AppConfig, ServiceData&gt;
    fetchDataRT(String itemId) {
  return ReaderT.of(config -&gt;
      FUTURE.widen(CompletableFuture.supplyAsync(() -&gt;
          callApi(config.apiKey(), config.serviceUrl(), itemId))));
}

ReaderT&lt;CompletableFutureKind.Witness, AppConfig, ProcessedData&gt;
    processDataRT(ServiceData data) {
  return ReaderT.reader(futureMonad,
      config -&gt; transform(data, config.apiKey()));
}

// Config provided once, at the end:
Kind&lt;CompletableFutureKind.Witness, ProcessedData&gt; result =
    composedWorkflow.run().apply(prodConfig);
</code></pre>
<p>The <code>AppConfig</code> is threaded implicitly through <code>flatMap</code>. Each operation declares its dependency on <code>AppConfig</code> in its return type, but never receives it as a parameter. The config is provided once, when you run the computation.</p>
<pre><code>    ┌──────────────────────────────────────────────────────────┐
    │  ReaderT&lt;CompletableFutureKind.Witness, AppConfig, A&gt;    │
    │                                                          │
    │        ┌── AppConfig ──┐                                 │
    │        │               │                                 │
    │        │  apiKey       │                                 │
    │        │  serviceUrl   │                                 │
    │        │  executor     │                                 │
    │        └───────┬───────┘                                 │
    │                │                                         │
    │                ▼                                         │
    │   ┌─── Function: R → Kind&lt;F, A&gt; ───────────────────┐     │
    │   │                                                │     │
    │   │  config → CompletableFuture&lt;result&gt;            │     │
    │   │                                                │     │
    │   └────────────────────────────────────────────────┘     │
    │                                                          │
    │  flatMap ──▶ threads same config to next operation       │
    │  map ──────▶ transforms result, config unchanged         │
    │  ask ──────▶ gives you the config itself                 │
    │  run ──────▶ provides config, returns F&lt;A&gt;               │
    └──────────────────────────────────────────────────────────┘
</code></pre>
<hr />
<h2 id="how-readert-works"><a class="header" href="#how-readert-works">How ReaderT Works</a></h2>
<p><code>ReaderT&lt;F, R, A&gt;</code> wraps a function <code>R -&gt; Kind&lt;F, A&gt;</code>. When you supply an environment of type <code>R</code>, you get back a monadic value <code>Kind&lt;F, A&gt;</code>.</p>
<p><img src="../images/puml/readert_transformer.svg" alt="readert_transformer.svg" /></p>
<ul>
<li><strong><code>F</code></strong>: The witness type of the <strong>outer monad</strong> (e.g., <code>CompletableFutureKind.Witness</code>).</li>
<li><strong><code>R</code></strong>: The type of the <strong>read-only environment</strong> (configuration, dependencies).</li>
<li><strong><code>A</code></strong>: The type of the value produced, within the outer monad <code>F</code>.</li>
<li><strong><code>run</code></strong>: The core function <code>R -&gt; Kind&lt;F, A&gt;</code>.</li>
</ul>
<pre><code class="language-java">public record ReaderT&lt;F, R, A&gt;(@NonNull Function&lt;R, Kind&lt;F, A&gt;&gt; run)
    implements ReaderTKind&lt;F, R, A&gt; {
  // ... static factory methods ...
}
</code></pre>
<hr />
<h2 id="setting-up-readertmonad"><a class="header" href="#setting-up-readertmonad">Setting Up ReaderTMonad</a></h2>
<p>The <code>ReaderTMonad&lt;F, R&gt;</code> class implements <code>Monad&lt;ReaderTKind.Witness&lt;F, R&gt;&gt;</code>, providing standard monadic operations. It requires a <code>Monad&lt;F&gt;</code> instance for the outer monad:</p>
<pre><code class="language-java">OptionalMonad optionalMonad = OptionalMonad.INSTANCE;
record AppConfig(String apiKey) {}

ReaderTMonad&lt;OptionalKind.Witness, AppConfig&gt; readerTOptionalMonad =
    new ReaderTMonad&lt;&gt;(optionalMonad);
</code></pre>
<div id="admonition-type-witness-and-helpers" class="admonition admonish-note" role="note" aria-labelledby="admonition-type-witness-and-helpers-title">
<div class="admonition-title">
<div id="admonition-type-witness-and-helpers-title">
<p>Type Witness and Helpers</p>
</div>
<a class="admonition-anchor-link" href="#admonition-type-witness-and-helpers"></a>
</div>
<div>
<p><strong>Witness Type:</strong> <code>ReaderTKind&lt;F, R, A&gt;</code> extends <code>Kind&lt;ReaderTKind.Witness&lt;F, R&gt;, A&gt;</code>. The outer monad <code>F</code> and environment <code>R</code> are fixed; <code>A</code> is the variable value type.</p>
<p><strong>KindHelper:</strong> <code>ReaderTKindHelper</code> provides <code>READER_T.widen</code> and <code>READER_T.narrow</code> for safe conversion.</p>
<pre><code class="language-java">Kind&lt;ReaderTKind.Witness&lt;F, R&gt;, A&gt; kind = READER_T.widen(readerT);
ReaderT&lt;F, R, A&gt; concrete = READER_T.narrow(kind);
</code></pre>
</div>
</div>
<hr />
<h2 id="key-operations"><a class="header" href="#key-operations">Key Operations</a></h2>
<div id="admonition-key-operations-with-_readertmonad_" class="admonition admonish-info" role="note" aria-labelledby="admonition-key-operations-with-_readertmonad_-title">
<div class="admonition-title">
<div id="admonition-key-operations-with-_readertmonad_-title">
<p>Key Operations with <em>ReaderTMonad</em></p>
</div>
<a class="admonition-anchor-link" href="#admonition-key-operations-with-_readertmonad_"></a>
</div>
<div>
<ul>
<li><strong><code>readerTMonad.of(value)</code></strong>: Lifts a pure value into <code>ReaderT</code>. The environment is ignored. Result: <code>ReaderT(r -&gt; outerMonad.of(value))</code>.</li>
<li><strong><code>readerTMonad.map(func, readerTKind)</code></strong>: Transforms the result value <code>A -&gt; B</code> within the outer monad. The environment passes through unchanged. Result: <code>ReaderT(r -&gt; F&lt;B&gt;)</code>.</li>
<li><strong><code>readerTMonad.flatMap(func, readerTKind)</code></strong>: The core sequencing operation. Runs the first <code>ReaderT</code> with the environment to get <code>Kind&lt;F, A&gt;</code>. If it yields an <code>A</code>, applies <code>func</code> to get a new <code>ReaderT&lt;F, R, B&gt;</code>, which is then also run with the <strong>same environment</strong>. This is what makes configuration threading automatic.</li>
</ul>
</div>
</div>
<hr />
<h2 id="creating-readert-instances"><a class="header" href="#creating-readert-instances">Creating ReaderT Instances</a></h2>
<div id="admonition-creating-_readert_-instances" class="admonition admonish-note" role="note" aria-labelledby="admonition-creating-_readert_-instances-title">
<div class="admonition-title">
<div id="admonition-creating-_readert_-instances-title">
<p>Creating <em>ReaderT</em> Instances</p>
</div>
<a class="admonition-anchor-link" href="#admonition-creating-_readert_-instances"></a>
</div>
<div>
<pre><code class="language-java">OptionalMonad optMonad = OptionalMonad.INSTANCE;
record Config(String setting) {}
Config testConfig = new Config("TestValue");

// 1. Directly from R -&gt; F&lt;A&gt; function
ReaderT&lt;OptionalKind.Witness, Config, String&gt; rt1 = ReaderT.of(
    cfg -&gt; OPTIONAL.widen(Optional.of("Data based on " + cfg.setting())));
// Run: OPTIONAL.narrow(rt1.run().apply(testConfig))
// → Optional.of("Data based on TestValue")

// 2. Lifting an existing F&lt;A&gt; (environment ignored)
Kind&lt;OptionalKind.Witness, Integer&gt; optionalValue =
    OPTIONAL.widen(Optional.of(123));
ReaderT&lt;OptionalKind.Witness, Config, Integer&gt; rt2 =
    ReaderT.lift(optMonad, optionalValue);
// Run: always returns Optional.of(123) regardless of config

// 3. From R -&gt; A function (result lifted into F)
ReaderT&lt;OptionalKind.Witness, Config, String&gt; rt3 =
    ReaderT.reader(optMonad, cfg -&gt; "Hello from " + cfg.setting());
// Run: Optional.of("Hello from TestValue")

// 4. ask: provides the environment itself as the result
ReaderT&lt;OptionalKind.Witness, Config, Config&gt; rt4 = ReaderT.ask(optMonad);
// Run: Optional.of(Config("TestValue"))
</code></pre>
</div>
</div>
<hr />
<h2 id="real-world-example-configuration-dependent-async-services"><a class="header" href="#real-world-example-configuration-dependent-async-services">Real-World Example: Configuration-Dependent Async Services</a></h2>
<div id="admonition-configuration-dependent-asynchronous-service-calls" class="admonition admonish-note" role="note" aria-labelledby="admonition-configuration-dependent-asynchronous-service-calls-title">
<div class="admonition-title">
<div id="admonition-configuration-dependent-asynchronous-service-calls-title">
<p>Configuration-Dependent Asynchronous Service Calls</p>
</div>
<a class="admonition-anchor-link" href="#admonition-configuration-dependent-asynchronous-service-calls"></a>
</div>
<div>
<ul>
<li><a href="https://github.com/higher-kinded-j/higher-kinded-j/blob/main/hkj-examples/src/main/java/org/higherkindedj/example/basic/reader_t/ReaderTAsyncExample.java">ReaderTAsyncExample.java</a></li>
</ul>
<p><strong>The problem:</strong> You have async service operations that all need an <code>AppConfig</code> (API keys, URLs, executor). You want to compose them without passing config through every call.</p>
<p><strong>The solution:</strong></p>
<pre><code class="language-java">static final Monad&lt;CompletableFutureKind.Witness&gt; futureMonad =
    CompletableFutureMonad.INSTANCE;
static final ReaderTMonad&lt;CompletableFutureKind.Witness, AppConfig&gt; cfReaderTMonad =
    new ReaderTMonad&lt;&gt;(futureMonad);

record AppConfig(String apiKey, String serviceUrl, ExecutorService executor) {}
record ServiceData(String rawData) {}
record ProcessedData(String info) {}

// Operation 1: fetch data (needs config for URL and API key)
static ReaderT&lt;CompletableFutureKind.Witness, AppConfig, ServiceData&gt;
    fetchServiceDataRT(String itemId) {
  return ReaderT.of(config -&gt; FUTURE.widen(
      CompletableFuture.supplyAsync(() -&gt;
          new ServiceData("Raw data for " + itemId + " from " + config.serviceUrl()),
          config.executor())));
}

// Operation 2: process data (needs config for API key)
static ReaderT&lt;CompletableFutureKind.Witness, AppConfig, ProcessedData&gt;
    processDataRT(ServiceData data) {
  return ReaderT.reader(futureMonad,
      config -&gt; new ProcessedData("Processed: " + data.rawData().toUpperCase()));
}

// Compose: fetch then process
Kind&lt;ReaderTKind.Witness&lt;CompletableFutureKind.Witness, AppConfig&gt;, ProcessedData&gt;
    workflowRT = cfReaderTMonad.flatMap(
        data -&gt; READER_T.widen(processDataRT(data)),
        READER_T.widen(fetchServiceDataRT("item123")));

ReaderT&lt;CompletableFutureKind.Witness, AppConfig, ProcessedData&gt; composedWorkflow =
    READER_T.narrow(workflowRT);

// Run with different configs:
AppConfig prodConfig = new AppConfig("prod_key", "https://api.prod.example.com", executor);
AppConfig stagingConfig = new AppConfig("staging_key", "https://api.staging.example.com", executor);

ProcessedData prodResult = FUTURE.join(composedWorkflow.run().apply(prodConfig));
ProcessedData stagingResult = FUTURE.join(composedWorkflow.run().apply(stagingConfig));
</code></pre>
<p><strong>Why this works:</strong> The <code>AppConfig</code> is threaded through both <code>fetchServiceDataRT</code> and <code>processDataRT</code> by <code>flatMap</code>. The same workflow runs against production and staging simply by providing different configs at the <code>run().apply(...)</code> call. The workflow definition is completely decoupled from the environment.</p>
</div>
</div>
<hr />
<h2 id="using-ask-to-access-configuration-mid-workflow"><a class="header" href="#using-ask-to-access-configuration-mid-workflow">Using <code>ask</code> to Access Configuration Mid-Workflow</a></h2>
<div id="admonition-accessing-configuration-with-ask" class="admonition admonish-note" role="note" aria-labelledby="admonition-accessing-configuration-with-ask-title">
<div class="admonition-title">
<div id="admonition-accessing-configuration-with-ask-title">
<p>Accessing Configuration with <code>ask</code></p>
</div>
<a class="admonition-anchor-link" href="#admonition-accessing-configuration-with-ask"></a>
</div>
<div>
<p><strong>The problem:</strong> Within a composed workflow, you need to read a specific config value without restructuring the computation.</p>
<p><strong>The solution:</strong></p>
<pre><code class="language-java">ReaderT&lt;CompletableFutureKind.Witness, AppConfig, AppConfig&gt; getConfigRT =
    ReaderT.ask(futureMonad);

Kind&lt;ReaderTKind.Witness&lt;CompletableFutureKind.Witness, AppConfig&gt;, String&gt;
    getServiceUrlRT = cfReaderTMonad.map(
        (AppConfig cfg) -&gt; "Service URL: " + cfg.serviceUrl(),
        READER_T.widen(getConfigRT));

String stagingUrl = FUTURE.join(
    READER_T.narrow(getServiceUrlRT).run().apply(stagingConfig));
// → "Service URL: https://api.staging.example.com"
</code></pre>
<p><code>ReaderT.ask</code> returns the entire environment as the result, which you can then <code>map</code> over to extract specific fields.</p>
</div>
</div>
<hr />
<h2 id="fire-and-forget-operations-with-unit"><a class="header" href="#fire-and-forget-operations-with-unit">Fire-and-Forget Operations with Unit</a></h2>
<div id="admonition-readert-for-actions-returning-unit" class="admonition admonish-note" role="note" aria-labelledby="admonition-readert-for-actions-returning-unit-title">
<div class="admonition-title">
<div id="admonition-readert-for-actions-returning-unit-title">
<p><code>ReaderT</code> for Actions Returning <code>Unit</code></p>
</div>
<a class="admonition-anchor-link" href="#admonition-readert-for-actions-returning-unit"></a>
</div>
<div>
<ul>
<li><a href="https://github.com/higher-kinded-j/higher-kinded-j/blob/main/hkj-examples/src/main/java/org/higherkindedj/example/basic/reader_t/ReaderTAsyncUnitExample.java">ReaderTAsyncUnitExample.java</a></li>
</ul>
<p><strong>The problem:</strong> Some operations (logging, initialisation, sending metrics) depend on configuration but don't produce a meaningful return value.</p>
<p><strong>The solution:</strong> Use <code>Unit</code> as the value type:</p>
<pre><code class="language-java">static ReaderT&lt;CompletableFutureKind.Witness, AppConfig, Unit&gt; initialiseComponentRT() {
    return ReaderT.of(config -&gt; FUTURE.widen(
        CompletableFuture.runAsync(() -&gt; {
            System.out.println("Initialising with API Key: " + config.apiKey());
            // ... initialisation work ...
        }, config.executor()).thenApply(v -&gt; Unit.INSTANCE)));
}

// Run:
Unit result = FUTURE.join(initialiseComponentRT().run().apply(prodConfig));
// → () (Unit.INSTANCE, signifying successful completion)
</code></pre>
</div>
</div>
<hr />
<div id="admonition-common-mistakes" class="admonition admonish-warning" role="note" aria-labelledby="admonition-common-mistakes-title">
<div class="admonition-title">
<div id="admonition-common-mistakes-title">
<p>Common Mistakes</p>
</div>
<a class="admonition-anchor-link" href="#admonition-common-mistakes"></a>
</div>
<div>
<ul>
<li><strong>Forgetting to run:</strong> A <code>ReaderT</code> is a <em>description</em> of a computation, not the computation itself. It does nothing until you call <code>.run().apply(config)</code>. If your tests pass but nothing happens, check that you are running the <code>ReaderT</code>.</li>
<li><strong>Mutating the environment:</strong> <code>R</code> should be immutable. <code>ReaderT</code> passes the same <code>R</code> to every operation in a chain. Mutating it would break referential transparency and produce unpredictable results.</li>
<li><strong>Using ReaderT when you need state changes:</strong> If the configuration changes between steps, you need <code>StateT</code>, not <code>ReaderT</code>. The "Reader" in <code>ReaderT</code> means <em>read-only</em>.</li>
</ul>
</div>
</div>
<hr />
<div id="admonition-see-also" class="admonition admonish-tip" role="note" aria-labelledby="admonition-see-also-title">
<div class="admonition-title">
<div id="admonition-see-also-title">
<p>See Also</p>
</div>
<a class="admonition-anchor-link" href="#admonition-see-also"></a>
</div>
<div>
<ul>
<li><a href="transformers.html">Monad Transformers</a> - General concept and choosing the right transformer</li>
<li><a href="statet_transformer.html">StateT</a> - When your environment needs to change between steps</li>
<li><a href="eithert_transformer.html">EitherT</a> - When operations can fail with typed errors</li>
</ul>
</div>
</div>
<hr />
<div id="admonition-further-reading" class="admonition admonish-tip" role="note" aria-labelledby="admonition-further-reading-title">
<div class="admonition-title">
<div id="admonition-further-reading-title">
<p>Further Reading</p>
</div>
<a class="admonition-anchor-link" href="#admonition-further-reading"></a>
</div>
<div>
<ul>
<li><a href="https://medium.com/@johnmcclean/reader-monad-for-dependency-injection-in-java-9056d9501c75">Reader Monad for Dependency Injection</a> - Practical examples without frameworks (12 min read)</li>
<li><a href="https://www.youtube.com/watch?v=ZasXwtTRkio">Functional Dependency Injection</a> - Conference talk on Reader pattern (40 min watch)</li>
<li><a href="https://academy.fpblock.com/blog/2017/06/readert-design-pattern/">ReaderT Design Pattern</a> - Michael Snoyman's production patterns (30 min read)</li>
<li><a href="https://rockthejvm.com/articles/a-fresh-perspective-on-monads">A Fresh Perspective on Monads</a> - Rock the JVM on composing monadic effects (20 min read)</li>
</ul>
</div>
</div>
<p><strong>Previous:</strong> <a href="maybet_transformer.html">MaybeT</a>
<strong>Next:</strong> <a href="statet_transformer.html">StateT</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../transformers/maybet_transformer.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../transformers/statet_transformer.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../transformers/maybet_transformer.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../transformers/statet_transformer.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../version-switcher.js"></script>
        <script src=".././theme/version-switcher.js"></script>
        <script src=".././theme/sidebar-nav-link.js"></script>


    </div>
    </body>
</html>
