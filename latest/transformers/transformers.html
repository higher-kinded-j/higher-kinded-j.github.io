<!DOCTYPE HTML>
<html lang="en" class="latte sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Monad Transformers - Higher-Kinded-J: Composable Effects and Advanced Optics for Java</title>


        <!-- Custom HTML head -->


            <meta name="description" content="The most comprehensive functional programming library for Java. Unify error handling, optional values, and immutable data navigation with the Effect Path API and Focus DSL. Features advanced optics with code generation for Java records, filtered traversals, indexed optics, and seamless Spring Boot integration.">


        <meta name="keywords" content="Higher-Kinded Types, Higher-Kinded-J, HKT, Java, Optics, Lens, Prism, Traversal, Iso, Affine, Focus DSL, Effect Path API, Functional Programming, Monad, Functor, Applicative, EitherPath, MaybePath, TryPath, ValidationPath, Java Records, Sealed Interface, Error Handling, Immutable Data">
        
        <meta property="og:title" content="Monad Transformers - Higher-Kinded-J: Composable Effects and Advanced Optics for Java">
            <meta property="og:description" content="The most comprehensive functional programming library for Java. Unify error handling, optional values, and immutable data navigation with the Effect Path API and Focus DSL. Features advanced optics with code generation for Java records, filtered traversals, indexed optics, and seamless Spring Boot integration.">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://higher-kinded-j.github.io/">
        <meta property="og:image" content="https://higher-kinded-j.github.io/preview.png">
        <meta property="og:image:width" content="1200">
        <meta property="og:image:height" content="630">
        <meta property="og:site_name" content="Higher-Kinded-J Documentation">
        <meta property="og:locale" content="en_GB">
        
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="Monad Transformers - Higher-Kinded-J: Composable Effects and Advanced Optics for Java">
        <meta name="twitter:description" content="Unifying Composable Effects and Advanced Optics for Java. Effect Path API, Focus DSL, and the most comprehensive optics implementation in the Java ecosystem.">
        <meta name="twitter:image" content="https://higher-kinded-j.github.io/preview.png">
        <meta name="twitter:image:alt" content="Higher-Kinded-J: Composable Effects and Advanced Optics for Java">
        <meta name="description" content="The most comprehensive functional programming library for Java. Unify error handling, optional values, and immutable data navigation with the Effect Path API and Focus DSL. Features advanced optics with code generation for Java records, filtered traversals, indexed optics, and seamless Spring Boot integration.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">
        <meta name="google-site-verification" content="X-xsiAq2cKMLOzh9dexUrX8Onx2h_YMUFgp5lHHUwSg" />
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././mdbook-admonish.css">
        <link rel="stylesheet" href=".././theme/catppuccin.css">
        <link rel="stylesheet" href=".././theme/catppuccin-admonish.css">
        <link rel="stylesheet" href=".././theme/catppuccin-alerts.css">
        <link rel="stylesheet" href=".././theme/additional-hkj.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "latte";
            const default_dark_theme = "macchiato";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('latte')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <div class="version-selector-container">
                            <select id="version-selector" class="version-selector" aria-label="Select documentation version" title="Select documentation version">
                                <option value="">Loading versions...</option>
                            </select>
                        </div>
                    </div>

                    <h1 class="menu-title">Higher-Kinded-J: Composable Effects and Advanced Optics for Java</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/higher-kinded-j/higher-kinded-j" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/higher-kinded-j/higher-kinded-j/edit/main/hkj-book/src/transformers/transformers.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="the-transformers"><a class="header" href="#the-transformers">The Transformers:</a></h1>
<p><em>Combining Monadic Effects</em></p>
<blockquote>
<p><em>"Any sufficiently complicated program contains an ad hoc, informally-specified, bug-ridden, slow implementation of half of a monad transformer."</em></p>
<p>– A functional programmer's lament (after Greenspun's Tenth Rule)</p>
</blockquote>
<p>If you've ever written a utility method that takes a <code>CompletableFuture&lt;Either&lt;E, A&gt;&gt;</code> and tries to <code>flatMap</code> across both layers, you've already started building one. Transformers formalise the pattern.</p>
<div id="admonition-what-youll-learn" class="admonition admonish-info" role="note" aria-labelledby="admonition-what-youll-learn-title">
<div class="admonition-title">
<div id="admonition-what-youll-learn-title">
<p>What You'll Learn</p>
</div>
<a class="admonition-anchor-link" href="#admonition-what-youll-learn"></a>
</div>
<div>
<ul>
<li>Why directly nesting monadic types like <code>CompletableFuture&lt;Either&lt;E, A&gt;&gt;</code> leads to complex, unwieldy code</li>
<li>How monad transformers wrap nested monads to provide a unified interface with familiar <code>map</code> and <code>flatMap</code> operations</li>
<li>The available transformers in Higher-Kinded-J: EitherT, MaybeT, OptionalT, ReaderT, and StateT</li>
<li>How to choose the right transformer for your use case based on the effect you need to add</li>
</ul>
</div>
</div>
<p><img src="../images/stand_back_monad_transformers.jpg" alt="stand_back_monad_transformers.jpg" /></p>
<hr />
<h2 id="the-problem-monads-dont-compose"><a class="header" href="#the-problem-monads-dont-compose">The Problem: Monads Don't Compose</a></h2>
<p>When building real applications, you rarely need just one effect. An operation might be <strong>asynchronous</strong> and also <strong>fail with domain errors</strong>. Another might require <strong>configuration</strong> and also be <strong>async</strong>. A third might need to <strong>track state</strong> while <strong>potentially returning nothing</strong>.</p>
<p>Each of these effects has a clean monadic representation in isolation. The trouble starts when you combine them.</p>
<h3 id="what-nesting-looks-like-in-practice"><a class="header" href="#what-nesting-looks-like-in-practice">What Nesting Looks Like in Practice</a></h3>
<p>Consider a service that fetches a user asynchronously and might fail:</p>
<pre><code class="language-java">// The nested type: async + typed error
CompletableFuture&lt;Either&lt;DomainError, User&gt;&gt; fetchUser(String userId) { ... }
CompletableFuture&lt;Either&lt;DomainError, Order&gt;&gt; createOrder(User user) { ... }
CompletableFuture&lt;Either&lt;DomainError, Receipt&gt;&gt; processPayment(Order order) { ... }

// Composing them manually:
CompletableFuture&lt;Either&lt;DomainError, Receipt&gt;&gt; workflow =
    fetchUser("user-42").thenCompose(eitherUser -&gt;
        eitherUser.fold(
            error -&gt; CompletableFuture.completedFuture(Either.left(error)),
            user -&gt; createOrder(user).thenCompose(eitherOrder -&gt;
                eitherOrder.fold(
                    error -&gt; CompletableFuture.completedFuture(Either.left(error)),
                    order -&gt; processPayment(order)
                )
            )
        )
    );
</code></pre>
<p>Three steps. Already deeply nested. Every step requires the same boilerplate: check if the inner <code>Either</code> is <code>Left</code>, propagate the error, or unwrap the <code>Right</code> and continue. Add a fourth step and the indentation grows further. Add error recovery and it becomes genuinely difficult to read.</p>
<p>The problem is structural: <code>CompletableFuture</code> and <code>Either</code> each have their own <code>flatMap</code>, but Java gives you no way to unify them into a single sequencing operation.</p>
<hr />
<h2 id="the-solution-transformer-as-wrapper"><a class="header" href="#the-solution-transformer-as-wrapper">The Solution: Transformer as Wrapper</a></h2>
<p>A monad transformer <code>T</code> takes an outer monad <code>F</code> and produces a <strong>new monad</strong> <code>T&lt;F&gt;</code> that combines both effects. The transformer handles the interleaving of contexts automatically.</p>
<pre><code>    ┌───────────────────────────────────────────────────────────────┐
    │  HOW A TRANSFORMER WORKS                                      │
    │                                                               │
    │                   ┌─────────────────────────┐                 │
    │                   │   Transformer (EitherT) │                 │
    │                   │                         │                 │
    │   flatMap ───────▶│  1. Sequence outer F    │──────▶ result   │
    │                   │  2. Check inner Either  │                 │
    │                   │  3. Route: Left → skip  │                 │
    │                   │          Right → apply  │                 │
    │                   └─────────────────────────┘                 │
    │                                                               │
    │   You call one flatMap. The transformer does both.            │
    └───────────────────────────────────────────────────────────────┘
</code></pre>
<p>The same workflow with <code>EitherT</code>:</p>
<pre><code class="language-java">EitherTMonad&lt;CompletableFutureKind.Witness, DomainError&gt; eitherTMonad =
    new EitherTMonad&lt;&gt;(CompletableFutureMonad.INSTANCE);

Kind&lt;EitherTKind.Witness&lt;CompletableFutureKind.Witness, DomainError&gt;, Receipt&gt; workflow =
    For.from(eitherTMonad, EitherT.fromKind(fetchUser("user-42")))
        .from(user -&gt; EitherT.fromKind(createOrder(user)))
        .from(order -&gt; EitherT.fromKind(processPayment(order)))
        .yield((user, order, receipt) -&gt; receipt);
</code></pre>
<p>One <code>flatMap</code> sequences the async operation <em>and</em> propagates errors. No manual <code>fold</code>, no repeated <code>Either.left</code> wrapping, no growing indentation. The nesting is still there (it must be), but the transformer hides it.</p>
<hr />
<h2 id="key-characteristics"><a class="header" href="#key-characteristics">Key Characteristics</a></h2>
<ol>
<li><strong>Stacking</strong> – Transformers allow "stacking" monadic effects in a standard way</li>
<li><strong>Unified Interface</strong> – The resulting transformed monad implements <code>Monad</code> (and often <code>MonadError</code>), so you use the same <code>map</code>, <code>flatMap</code>, <code>of</code> you already know</li>
<li><strong>Abstraction</strong> – The complexity of managing the nested structure is encapsulated; you work with a single monadic layer</li>
</ol>
<div id="admonition-witness-type-requirement" class="admonition admonish-note" role="note" aria-labelledby="admonition-witness-type-requirement-title">
<div class="admonition-title">
<div id="admonition-witness-type-requirement-title">
<p>Witness Type Requirement</p>
</div>
<a class="admonition-anchor-link" href="#admonition-witness-type-requirement"></a>
</div>
<div>
<p>All transformers require an outer monad <code>F</code> where <code>F extends WitnessArity&lt;TypeArity.Unary&gt;</code>. This ensures the transformer can work with any properly-typed monad in the framework.</p>
</div>
</div>
<hr />
<h2 id="transformers-in-higher-kinded-j"><a class="header" href="#transformers-in-higher-kinded-j">Transformers in Higher-Kinded-J</a></h2>
<p><img src="../images/puml/supported_transformers.svg" alt="supported_transformers.svg" /></p>
<p>Higher-Kinded-J provides five transformers. Each solves a specific composition problem:</p>
<h3 id="eithert-typed-errors-in-any-context"><a class="header" href="#eithert-typed-errors-in-any-context">EitherT: Typed Errors in Any Context</a></h3>
<p><strong>The problem:</strong> Your async operation can fail with a domain-specific error, and you need to sequence multiple such operations without manual error propagation.</p>
<p><strong>The solution:</strong> <code>EitherT&lt;F, E, A&gt;</code> wraps <code>Kind&lt;F, Either&lt;E, A&gt;&gt;</code> and provides <code>MonadError&lt;..., E&gt;</code>, giving you <code>flatMap</code> for sequencing, <code>raiseError</code> for failures, and <code>handleErrorWith</code> for recovery.</p>
<p><strong>Usage:</strong> <a href="eithert_transformer.html">How to use the EitherT Monad Transformer</a></p>
<hr />
<h3 id="optionalt-when-absence-meets-other-effects"><a class="header" href="#optionalt-when-absence-meets-other-effects">OptionalT: When Absence Meets Other Effects</a></h3>
<p><strong>The problem:</strong> Your async data retrieval might return nothing (user not found, config missing), and you need to chain lookups without checking each <code>Optional</code> manually.</p>
<p><strong>The solution:</strong> <code>OptionalT&lt;F, A&gt;</code> wraps <code>Kind&lt;F, Optional&lt;A&gt;&gt;</code> and provides <code>MonadError&lt;..., Unit&gt;</code>, where <code>Unit</code> represents the "empty" state. Chain lookups with <code>flatMap</code>; if any step returns empty, the rest are skipped.</p>
<p><strong>Usage:</strong> <a href="optionalt_transformer.html">How to use the OptionalT Monad Transformer</a></p>
<hr />
<h3 id="maybet-functional-optionality-across-monads"><a class="header" href="#maybet-functional-optionality-across-monads">MaybeT: Functional Optionality Across Monads</a></h3>
<p><strong>The problem:</strong> Same as OptionalT, but you're using Higher-Kinded-J's <code>Maybe</code> type rather than <code>java.util.Optional</code>.</p>
<p><strong>The solution:</strong> <code>MaybeT&lt;F, A&gt;</code> wraps <code>Kind&lt;F, Maybe&lt;A&gt;&gt;</code> with the same <code>MonadError&lt;..., Unit&gt;</code> interface. Functionally equivalent to OptionalT; choose based on which optional type your codebase uses.</p>
<p><strong>Usage:</strong> <a href="maybet_transformer.html">How to use the MaybeT Monad Transformer</a></p>
<hr />
<h3 id="readert-threading-configuration-through-effects"><a class="header" href="#readert-threading-configuration-through-effects">ReaderT: Threading Configuration Through Effects</a></h3>
<p><strong>The problem:</strong> Multiple operations need access to shared configuration (database URLs, API keys, feature flags), and each is also wrapped in another effect like <code>CompletableFuture</code>. Passing the config manually through every function signature is tedious and error-prone.</p>
<p><strong>The solution:</strong> <code>ReaderT&lt;F, R, A&gt;</code> wraps a function <code>R -&gt; Kind&lt;F, A&gt;</code>. The environment <code>R</code> is provided once at the end, when you run the computation; all intermediate operations receive it implicitly through <code>flatMap</code>.</p>
<p><strong>Usage:</strong> <a href="readert_transformer.html">How to use the ReaderT Monad Transformer</a></p>
<hr />
<h3 id="statet-managing-state-across-effect-boundaries"><a class="header" href="#statet-managing-state-across-effect-boundaries">StateT: Managing State Across Effect Boundaries</a></h3>
<p><strong>The problem:</strong> You need to thread mutable state through a sequence of operations that are also wrapped in another effect (e.g., a stack that can fail on pop, a counter that increments across async steps).</p>
<p><strong>The solution:</strong> <code>StateT&lt;S, F, A&gt;</code> wraps a function <code>S -&gt; Kind&lt;F, StateTuple&lt;S, A&gt;&gt;</code>. Each <code>flatMap</code> threads the updated state to the next operation; the outer monad's effects are handled simultaneously.</p>
<p><strong>Usage:</strong> <a href="statet_transformer.html">How to use the StateT Monad Transformer</a></p>
<hr />
<h2 id="transformer-patterns-at-a-glance"><a class="header" href="#transformer-patterns-at-a-glance">Transformer Patterns at a Glance</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Pattern</th><th>Transformer</th><th>Outer Monad</th><th>What You Get</th></tr></thead><tbody>
<tr><td>Async + Error</td><td><code>EitherT</code></td><td><code>CompletableFuture</code></td><td>Async workflows with typed error propagation</td></tr>
<tr><td>Async + Absence</td><td><code>OptionalT</code> / <code>MaybeT</code></td><td><code>CompletableFuture</code></td><td>Async lookups that may return nothing</td></tr>
<tr><td>Config + Async</td><td><code>ReaderT</code></td><td><code>CompletableFuture</code></td><td>Dependency injection for async services</td></tr>
<tr><td>Config + Error</td><td><code>ReaderT</code></td><td><code>Either</code></td><td>Environment-dependent computations that can fail</td></tr>
<tr><td>State + Failure</td><td><code>StateT</code></td><td><code>Optional</code> / <code>Either</code></td><td>Stateful operations that can short-circuit</td></tr>
<tr><td>State + Async</td><td><code>StateT</code></td><td><code>CompletableFuture</code></td><td>State threading across async boundaries</td></tr>
</tbody></table>
</div>
<hr />
<div id="admonition-common-pitfalls" class="admonition admonish-warning" role="note" aria-labelledby="admonition-common-pitfalls-title">
<div class="admonition-title">
<div id="admonition-common-pitfalls-title">
<p>Common Pitfalls</p>
</div>
<a class="admonition-anchor-link" href="#admonition-common-pitfalls"></a>
</div>
<div>
<ul>
<li><strong>Forgetting to unwrap:</strong> The result of a transformer computation is still wrapped. Call <code>.value()</code> on the transformer to extract the underlying <code>Kind&lt;F, Either&lt;E, A&gt;&gt;</code> (or equivalent) when you need to interact with the outer monad directly.</li>
<li><strong>Wrong monad order:</strong> <code>EitherT&lt;Future, E, A&gt;</code> (error inside future) is different from hypothetical <code>FutureT&lt;Either, E, A&gt;</code> (future inside error). The <em>outer</em> monad is the one the transformer wraps around; the <em>inner</em> effect is what the transformer adds. Choose based on which semantics you need.</li>
<li><strong>Overusing transformers:</strong> If you only combine effects in one or two places, manual nesting may be simpler. Transformers shine when the pattern is repeated across many operations.</li>
</ul>
</div>
</div>
<hr />
<p><strong>Previous:</strong> <a href="ch_intro.html">Introduction</a>
<strong>Next:</strong> <a href="eithert_transformer.html">EitherT</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../transformers/ch_intro.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../transformers/eithert_transformer.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../transformers/ch_intro.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../transformers/eithert_transformer.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../version-switcher.js"></script>
        <script src=".././theme/version-switcher.js"></script>
        <script src=".././theme/sidebar-nav-link.js"></script>


    </div>
    </body>
</html>
